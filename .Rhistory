load("hisse.RData")
ls()
install.packages("corHMM")
ls()
traits
traits
traits
trait1 <- cbind(names(traits$WCVP_name), traits$open_closed)
tree
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
trait1 <- cbind(names(traits$WCVP_name), traits$open_closed)
#open_closed
pp.polymorphic<-corHMM(tree,trait1,rate.cat=2,node.states="marginal")
trait1
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
pp.polymorphic<-corHMM(tree,trait1,rate.cat=2,node.states="marginal")
#open_closed
trait1 <- trait1[trait1[,1] != NA]
trati1
trait1
trait1[,1]
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
trait1 <- trait1[trait1[,1] != NA]
trait1
trait1
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
trait1
trait1[,1]
#open_closed
trait1
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait1<-trait1[!is.na(trait1[,2]),]
trait1
tree
tipstoremove <- setdiff(tree$tip.label,trait1[,1])
tipstoremove
mytree <- drop.tip(tree, tipstoremove)
mytree
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
pp.polymorphic
getwd()
update.packages(ask = FALSE, checkBuilt = TRUE)
pp.polymorphic
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
load("hisse.RData")
ls()
traits
tree
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
trait1
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait1<-trait1[!is.na(trait1[,2]),]
tipstoremove <- setdiff(tree$tip.label,trait1[,1])
mytree <- drop.tip(tree, tipstoremove)
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
load("hisse.RData")
ls()
traits
load("hisse.RData")
ls()
traits
tree
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
trait1
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait1<-trait1[!is.na(trait1[,2]),]
tipstoremove <- setdiff(tree$tip.label,trait1[,1])
mytree <- drop.tip(tree, tipstoremove)
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
pp.polymorphic
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
pp.polymorphic.1<-corHMM(mytree,trait1,rate.cat=1,node.states="marginal")
pp.polymorphic.1<-corHMM(mytree,trait1,rate.cat=1,node.states="marginal")
pp.polymorphic.1
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
pp.polymorphic.2<-corHMM(mytree,trait1,rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic.2<-corHMM(mytree,trait1,rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic.2
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
pp.polymorphic.3<-corHMM(mytree,trait1,rate.cat=1,model = "SYM", node.states="marginal")
pp.polymorphic.3<-corHMM(mytree,trait1,rate.cat=1,model = "SYM", node.states="marginal")
pp.polymorphic.3
pp.polymorphic
pp.polymorphic.1
pp.polymorphic.2
pp.polymorphic.3
summary(pp.polymorphic)
pp.polymorphic$AIC
pp.polymorphic.1$AIC
pp.polymorphic.2$AIC
pp.polymorphic.3$AIC
pdffn = paste0("corHMMmodel_open_closed.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic, rate.cat = 2, color = c("orange", "blue"))
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
pdffn = paste0("corHMMmodel_open_closed.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic, rate.cat = 2, color = c("orange", "blue"))
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2rates.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Polymorphic ARD and R1/R2 rates")
dev.off()
pdffn = paste0("polymorphicARDandR1R2ratesv2.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait1))),piecol=cols,cex=0.1)
trait <- trait1[,2]
names(trait) <- trait1[,1]
pdffn = paste0("polymorphicARDandR1R2ratesv2.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic$states,piecol=cols,cex=0.3)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2ratesfan.pdf")
pdf(file=pdffn, width=100, height=100)
plot(mytree,type="fan",cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic$states,piecol=cols,cex=0.1)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
#install.packages("corHMM")
library(corHMM)
library(phytools)
load("hisse.RData")
ls()
traits
tree
trait2 <- cbind(traits$WCVP_name, traits$C4)
#C4
trait1
trait2[,2][trait2[,2] == ""] <- NA
trait2[,2][trait2[,2] == "1"] <- 1
trait2[,2][trait2[,2] == "0"] <- 0
trait2[,2][trait2[,2] == "01"] <- 1
trait2<-trait2[!is.na(trait2[,2]),]
tipstoremove <- setdiff(tree$tip.label,trait2[,1])
mytree <- drop.tip(tree, tipstoremove)
pp.polymorphic2<-corHMM(mytree,trait2,rate.cat=2,node.states="marginal")
pp.polymorphic2
#install.packages("corHMM")
library(corHMM)
library(phytools)
pp.polymorphic2.1<-corHMM(mytree,trait2,rate.cat=1,node.states="marginal")
pp.polymorphic2.1
pp.polymorphic2.2<-corHMM(mytree,trait2,rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic2.2
pp.polymorphic2.3<-corHMM(mytree,trait2,rate.cat=1,model = "SYM", node.states="marginal")
pp.polymorphic2.3
pp.polymorphic2
pp.polymorphic2.1
pp.polymorphic2.2
pp.polymorphic2.3
pdffn = paste0("corHMMmodel_c4.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic2, rate.cat = 2, color = c("orange", "blue"))
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2rates_c4.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic2$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Polymorphic ARD and R1/R2 rates")
dev.off()
trait <- trait2[,2]
names(trait) <- trait2[,1]
pdffn = paste0("polymorphicARDandR1R2ratesv2_c4.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic2$states,piecol=cols,cex=0.3)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
pdffn = paste0("polymorphicARDandR1R2ratesfan_c4.pdf")
pdf(file=pdffn, width=100, height=100)
plot(mytree,type="fan",cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic2$states,piecol=cols,cex=0.1)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
#install.packages("corHMM")
library(corHMM)
library(phytools)
load("hisse.RData")
ls()
traits
tree
trait3 <- cbind(traits$WCVP_name, traits$wind_animal)
#wind_animal
trait3
trait3[,2][trait3[,2] == ""] <- NA
trait3[,2][trait3[,2] == "1"] <- 1
trait3[,2][trait3[,2] == "0"] <- 0
trait3[,2][trait3[,2] == "01"] <- 1
trait3<-trait3[!is.na(trait3[,2]),]
tipstoremove <- setdiff(tree$tip.label,trait3[,1])
mytree <- drop.tip(tree, tipstoremove)
pp.polymorphic3<-corHMM(mytree,trait3,rate.cat=2,node.states="marginal")
pp.polymorphic3
pp.polymorphic3.1<-corHMM(mytree,trait3,rate.cat=1,node.states="marginal")
pp.polymorphic3.1
pp.polymorphic3.2<-corHMM(mytree,trait3,rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic3.2
pp.polymorphic3.3<-corHMM(mytree,trait3,rate.cat=1,model = "SYM", node.states="marginal")
pp.polymorphic3.3
pdffn = paste0("corHMMmodel_wind_animal.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic3.2, rate.cat = 2, color = c("orange", "blue"))
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2rates_wind_animal.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic3.2$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Polymorphic SYM and R1/R2 rates")
dev.off()
cols <- c("grey", "grey", "orange", "orange")
pdffn = paste0("polymorphicARDandR1R2rates_wind_animal.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic3.2$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Polymorphic SYM and R1/R2 rates")
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2rates_wind_animal.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic3.2$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Polymorphic SYM and R1/R2 rates")
dev.off()
trait <- trait3[,2]
names(trait) <- trait3[,1]
pdffn = paste0("polymorphicARDandR1R2ratesv2_wind_animal.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic3.2$states,piecol=cols,cex=0.3)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2ratesfan_wind_animal.pdf")
pdf(file=pdffn, width=100, height=100)
plot(mytree,type="fan",cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic3.2$states,piecol=cols,cex=0.1)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
