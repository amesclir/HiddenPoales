tipstoremove3 <- setdiff(trait12[,1], mytree$tip.label)
library(corHMM)
library(phytools)
load("hisse.RData")
ls()
traits
mytree <- read.tree(file="final_tree.tree")
mytree
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
trait4 <- cbind(traits$WCVP_name, traits$annual_perennial)
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait4[,2][trait4[,2] == ""] <- NA
trait4[,2][trait4[,2] == "1"] <- 1
trait4[,2][trait4[,2] == "0"] <- 0
trait4[,2][trait4[,2] == "01"] <- 1
trait12 <- cbind(trait1, trait4)
trait12 <- trait12[,c(1,2,4)]
tipstoremove <- setdiff(trait12[,1], mytree$tip.label)
mytree <- drop.tip(mytree, tipstoremove)
setdiff(trait12[,1], mytree$tip.label)
setdiff(mytree$tip.label,trait12[,1])
tipstoremove
tipstoremove <- setdiff(mytree$tip.label,trait12[,1])
mytree <- drop.tip(mytree, tipstoremove)
setdiff(trait12[,1], mytree$tip.label)
setdiff(mytree$tip.label,trait12[,1])
library(corHMM)
library(phytools)
load("hisse.RData")
ls()
traits
mytree <- read.tree(file="final_tree.tree")
mytree
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
trait4 <- cbind(traits$WCVP_name, traits$annual_perennial)
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait4[,2][trait4[,2] == ""] <- NA
trait4[,2][trait4[,2] == "1"] <- 1
trait4[,2][trait4[,2] == "0"] <- 0
trait4[,2][trait4[,2] == "01"] <- 1
trait12 <- cbind(trait1, trait4)
trait12 <- trait12[,c(1,2,4)]
trait12<-trait12[!is.na(trait12[,2]),]
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
trait4 <- cbind(traits$WCVP_name, traits$annual_perennial)
trait11 <- cbind(traits$WCVP_name, traits$C4)
trait5 <- cbind(traits$WCVP_name, traits$CAM)
trait11[,2][trait11[,2] == ""] <- NA
trait11[,2][trait5[,2] == 1] <- 2
trait11[,2][trait11[,2] == "1"] <- 1
trait11[,2][trait11[,2] == "0"] <- 0
trait11[,2][trait11[,2] == "01"] <- 1
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait4[,2][trait4[,2] == ""] <- NA
trait4[,2][trait4[,2] == "1"] <- 1
trait4[,2][trait4[,2] == "0"] <- 0
trait4[,2][trait4[,2] == "01"] <- 1
trait12 <- cbind(trait1, trait4,trait11)
trait12 <- trait12[,c(1,2,4,6)]
trait12<-trait12[!is.na(trait12[,2]),]
trait12<-trait12[!is.na(trait12[,3]),]
trait12<-trait12[!is.na(trait12[,4]),]
tipstoremove <- setdiff(mytree$tip.label,trait12[,1])
mytree <- drop.tip(mytree, tipstoremove)
setdiff(trait12[,1], mytree$tip.label)
setdiff(mytree$tip.label,trait12[,1])
pp.polymorphic12a<-corHMM(mytree,trait12[,c(1,2,3)],rate.cat=2,node.states="marginal")
pp.polymorphic12a
pp.polymorphic12a.1<-corHMM(mytree,trait12[,c(1,2,3)],rate.cat=1,node.states="marginal")
pp.polymorphic12a.1
pp.polymorphic12a.2<-corHMM(mytree,trait12[,c(1,2,3)],rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic12a.2
pp.polymorphic12a.3<-corHMM(mytree,trait12[,c(1,2,3)],rate.cat=1,model = "SYM", node.states="marginal")
pp.polymorphic12a.3
pp.polymorphic12b<-corHMM(mytree,trait12[,c(1,2,4)],rate.cat=2,node.states="marginal")
library(corHMM)
library(phytools)
pp.polymorphic12c<-corHMM(mytree,trait12[,c(1,2)],rate.cat=2,node.states="marginal")
pp.polymorphic12c
pp.polymorphic12c.1<-corHMM(mytree,trait12[,c(1,2)],rate.cat=1,node.states="marginal")
pp.polymorphic12c.1
pp.polymorphic12c.2<-corHMM(mytree,trait12[,c(1,2)],rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic12c.2
pp.polymorphic12c.3<-corHMM(mytree,trait12[,c(1,2)],rate.cat=1,model = "SYM", node.states="marginal")
pp.polymorphic12c.3
pp.polymorphic12d<-corHMM(mytree,trait12[,c(1,3)],rate.cat=2,node.states="marginal")
pp.polymorphic12d
pp.polymorphic12d.1<-corHMM(mytree,trait12[,c(1,3)],rate.cat=1,node.states="marginal")
pp.polymorphic12d.1
pp.polymorphic12d.2<-corHMM(mytree,trait12[,c(1,3)],rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic12d.2
library(corHMM)
library(phytools)
pp.polymorphic12d<-corHMM(mytree,trait12[,c(1,3)],rate.cat=2,node.states="marginal")
pp.polymorphic12d
pp.polymorphic12d.1<-corHMM(mytree,trait12[,c(1,3)],rate.cat=1,node.states="marginal")
pp.polymorphic12d.1
pp.polymorphic12d.2<-corHMM(mytree,trait12[,c(1,3)],rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic12d.2
pp.polymorphic12d.3<-corHMM(mytree,trait12[,c(1,3)],rate.cat=1,model = "SYM", node.states="marginal")
pp.polymorphic12d.3
library(corHMM)
library(phytools)
pp.polymorphic12b<-corHMM(mytree,trait12[,c(1,2,4)],rate.cat=2,node.states="marginal")
LegendAndRateMat <- getStateMat4Dat(data)
RateMat <- LegendAndRateMat$rate.mat
data
LegendAndRateMat <- getStateMat4Dat(data)
getStateMat4Dat(data)
data(primates)
data <- primates[[2]]
LegendAndRateMat <- getStateMat4Dat(data)
RateMat <- LegendAndRateMat$rate.mat
RateMat
pars2equal <- list(c(1,2), c(3,4))
StateMatA_constrained <- equateStateMatPars(RateMat, pars2equal)
StateMatA_constrained
?matrix
seqmatrix <- matrix(data = c(NA, 1, 2, 3, NA, NA, 4, NA, NA), nrow = 3, ncol = 3)
seqmatrix
seqmatrix <- matrix(data = c(NA, 1, 2, 3, NA, NA, 4, NA, NA), nrow = 3, ncol = 3, byrow = T)
seqmatrix
seqmatrixsym <- matrix(data = c(NA, 1, 2, 1, NA, NA, 2, NA, NA), nrow = 3, ncol = 3, byrow = T)
seqmatrixsym
pp.polymorphic12e<-corHMM(mytree,trait12[,c(1,4)],rate.cat=2, model = seqmatrix, node.states="marginal")
data
seqmatrix[is.na(seqmatrix)] <- 0
seqmatrix <- matrix(data = c(NA, 1, 2, 3, NA, NA, 4, NA, NA), nrow = 3, ncol = 3, byrow = T)
seqmatrix
seqmatrix[is.na(seqmatrix)] <- 0
seqmatrixsym <- matrix(data = c(NA, 1, 2, 1, NA, NA, 2, NA, NA), nrow = 3, ncol = 3, byrow = T)
seqmatrixsym
seqmatrixsym[is.na(seqmatrixsym)] <- 0
pp.polymorphic12e<-corHMM(mytree,trait12[,c(1,4)],rate.cat=2, model = seqmatrix, node.states="marginal")
getStateMat4Dat(trait12[,c(1,4)])
LegendAndRateMat <- getStateMat4Dat(trait12[,c(1,4)])
RateMat <- LegendAndRateMat$rate.mat
RateMat
pars2equal <- list(c(1,2), c(3,4))
StateMatA_constrained <- equateStateMatPars(RateMat, pars2equal)
StateMatA_constrained
LegendAndRateMat <- getStateMat4Dat(trait12[,c(1,4)])
RateMat <- LegendAndRateMat$rate.mat
RateMat
RateMat[1,1]
RateMat[2,3]
RateMat[2,3] <- 0
RateMat[3,2] <- 0
RateMat[1,3] <- 4
RateMat
RateClassMat <- getRateCatMat(2) #
RateClassMat <- equateStateMatPars(RateClassMat, c(1,2))
RateClassMat
StateMats <- list(RateMat, RateMat)
StateMats
FullMat <- getFullMat(StateMats, RateClassMat)
FullMat
RateMat
RateMatsym <- RateMat
RateMatsym[1,2] <- 1
RateMatsym[1,3] <- 2
RateMatsym
StateMatssym <- list(RateMatsym, RateMatsym)
StateMatssym
FullMatsym <- getFullMat(StateMatssym, RateClassMat)
FullMatsym
pp.polymorphic12e<-corHMM(mytree,trait12[,c(1,4)],rate.cat=2, rate.mat = FullMat, node.states="marginal")
pp.polymorphic12e
pp.polymorphic12e.1<-corHMM(mytree,trait12[,c(1,4)],rate.cat=1,rate.mat = RateMat, node.states="marginal")
pp.polymorphic12e.1
pp.polymorphic12e.2<-corHMM(mytree,trait12[,c(1,4)],rate.cat=2, rate.mat = FullMatsym, node.states="marginal")
pp.polymorphic12e.2
pp.polymorphic12e.3<-corHMM(mytree,trait12[,c(1,4)],rate.cat=1, rate.mat = RateMatsym, node.states="marginal")
pp.polymorphic12e.3
library(corHMM)
pp.polymorphic12a
pp.polymorphic12c
pp.polymorphic12d
pp.polymorphic12e
LegendAndRateMat <- getStateMat4Dat(trait12[,c(1,2,4)])
LegendAndRateMat
RateMat <- LegendAndRateMat$rate.mat
RateMat
RateMat[2,3] <- 0
RateMat[3,2] <- 0
RateMat[5,6] <- 0
RateMat[6,5] <- 0
RateMat
RateMat[2,3] <- 0
RateMat[3,2] <- 0
RateMat[5,6] <- 0
RateMat[6,5] <- 0
RateMat[5,2] <- 5
RateMat[1,3] <- 6
RateMat[6,3] <- 7
RateMat[1,4] <- 8
RateMat[5,4] <- 9
RateMat[6,4] <- 10
RateMat[2,5] <- 11
RateMat[4,5] <- 12
RateMat[2,5] <- 11
RateMat[4,5] <- 12
RateMat[3,6] <- 13
RateMat[4,6] <- 14
RateMat
RateClassMat <- getRateCatMat(2) #
RateClassMat <- equateStateMatPars(RateClassMat, c(1,2))
RateClassMat
StateMats <- list(RateMat, RateMat)
StateMats
FullMat <- getFullMat(StateMats, RateClassMat)
FullMat
StateMats
FullMat <- getFullMat(StateMats, RateClassMat)
FullMat
RateMatsym <- RateMat
RateMatsym
RateMatsym <- RateMat
RateMatsym
RateMatsym[5,4] <- 1
RateMatsym[6,4] <- 2
RateMatsym[4,5] <- 4
RateMatsym[4,6] <- 6
RateMatsym[1,4] <- 3
RateMatsym[2,5] <- 5
RateMatsym[3,6] <- 7
RateMatsym
StateMatssym <- list(RateMatsym, RateMatsym)
StateMatssym
FullMatsym <- getFullMat(StateMatssym, RateClassMat)
FullMatsym
pp.polymorphic12b<-corHMM(mytree,trait12[,c(1,2,4)],rate.cat=2,rate.mat = FullMat, node.states="marginal")
library(corHMM)
library(phytools)
library(corHMM)
library(phytools)
library(corHMM)
library(phytools)
pp.polymorphic12b<-corHMM(mytree,trait12[,c(1,2,4)],rate.cat=2,rate.mat = FullMat, node.states="marginal")
pp.polymorphic12b
pp.polymorphic12b.1<-corHMM(mytree,trait12[,c(1,2,4)],rate.cat=1,rate.mat = RateMat, node.states="marginal")
pp.polymorphic12b.1
pp.polymorphic12b.2<-corHMM(mytree,trait12[,c(1,2,4)],rate.cat=2, rate.mat = FullMatsym, node.states="marginal")
library(corHMM)
library(phytools)
pp.polymorphic12b.2<-corHMM(mytree,trait12[,c(1,2,4)],rate.cat=2, rate.mat = FullMatsym, node.states="marginal")
pp.polymorphic12b.2
pp.polymorphic12b.3<-corHMM(mytree,trait12[,c(1,2,4)],rate.cat=1,rate.mat = RateMatsym, node.states="marginal")
pp.polymorphic12b.3
library(corHMM)
library(phytools)
pp.polymorphic12a
pp.polymorphic12a.1
pp.polymorphic12a.2
pp.polymorphic12a.3
pp.polymorphic12b
pp.polymorphic12b.1
pp.polymorphic12b.2
pp.polymorphic12b.3
pp.polymorphic12a
pp.polymorphic12b
pp.polymorphic12c
pp.polymorphic12c.1
pp.polymorphic12c.2
pp.polymorphic12c.3
pp.polymorphic12d
pp.polymorphic12d.1
pp.polymorphic12d.2
pp.polymorphic12d.3
pp.polymorphic12e
pp.polymorphic12e.1
pp.polymorphic12e.2
pp.polymorphic12e.3
pdffn = paste0("corHMMmodel_open_closed.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic12c, rate.cat = 2, color = "col.blind")
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2rates_open_closed.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic12c$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Open Close ARD and R1/R2 rates")
dev.off()
trait <- trait12[,2]
names(trait) <- trait12[,1]
pdffn = paste0("polymorphicARDandR1R2ratesv2_open_closed.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12c$states,piecol=cols,cex=0.3)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2ratesfan_open_closed.pdf")
pdf(file=pdffn, width=100, height=100)
plot(mytree,type="fan", show.tip.label = F, cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12c$states,piecol=cols,cex=0.1)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
pdffn = paste0("polymorphicARDandR1R2ratesfan_open_closed.jpg")
jpeg(file=pdffn, width=3500, height=3500)
plot(mytree,type="fan", show.tip.label = F, cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12c$states,piecol=cols,cex=0.1)
dev.off()
pdffn = paste0("corHMMmodel_annual_perennial.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic12d, rate.cat = 2, color = "col.blind")
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2rates_annual_perennial.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic12d$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Annual Perennial ARD and R1/R2 rates")
dev.off()
trait <- trait12[,3]
names(trait) <- trait12[,1]
pdffn = paste0("polymorphicARDandR1R2ratesv2_annual_perennial.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12d$states,piecol=cols,cex=0.3)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
cols <- c("white", "black", "red", "yellow")
pdffn = paste0("polymorphicARDandR1R2ratesfan_annual_perennial.pdf")
pdf(file=pdffn, width=100, height=100)
plot(mytree,type="fan", show.tip.label = F, cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12d$states,piecol=cols,cex=0.1)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
pdffn = paste0("polymorphicARDandR1R2ratesfan_annual_perennial.jpg")
jpeg(file=pdffn, width=3500, height=3500)
plot(mytree,type="fan", show.tip.label = F, cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12d$states,piecol=cols,cex=0.1)
dev.off()
pdffn = paste0("corHMMmodel_C3C4CAM.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic12e, rate.cat = 2, color = "col.blind" )
dev.off()
cols <- c("white", "black", "blue", "red", "yellow", "orange")
pdffn = paste0("polymorphicSYMandR1R2rates_C3C4CAM.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic12e$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="C3C4CAM ARD and R1/R2 rates")
dev.off()
trait <- trait12[,4]
names(trait) <- trait12[,1]
pdffn = paste0("polymorphicARDandR1R2ratesv2_C3C4CAM.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12e$states,piecol=cols,cex=0.3)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
cols <- c("white", "black", "blue", "red", "yellow", "orange")
pdffn = paste0("polymorphicARDandR1R2ratesfan_C3C4CAM.pdf")
pdf(file=pdffn, width=100, height=100)
plot(mytree,type="fan", show.tip.label = F,cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12e$states,piecol=cols,cex=0.1)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
pdffn = paste0("polymorphicARDandR1R2ratesfan_C3C4CAM.jpg")
jpeg(file=pdffn, width=3500, height=3500)
plot(mytree,type="fan", show.tip.label = F,cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12e$states,piecol=cols,cex=0.1)
dev.off()
pp.polymorphic12a
pdffn = paste0("corHMMmodel_open_close_annual_perennial.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic12a, rate.cat = 2, color = "col.blind" )
dev.off()
cols <- c("white", "black", "blue", "purple", "red", "yellow", "orange", "green")
pdffn = paste0("polymorphicARDandR1R2rates_open_close_annual_perennial.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic12a$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Open Close Annual Perennial ARD and R1/R2 rates")
dev.off()
trait <- paste(trait12[,2],trait12[,3], sep = "_")
names(trait) <- trait12[,1]
pdffn = paste0("polymorphicARDandR1R2ratesv2_open_close_annual_perennial.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12a$states,piecol=cols,cex=0.3)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
cols <- c("white", "black", "blue", "purple", "red", "yellow", "orange", "green")
pdffn = paste0("polymorphicARDandR1R2ratesfan_open_close_annual_perennial.pdf")
pdf(file=pdffn, width=100, height=100)
plot(mytree,type="fan", show.tip.label = F,cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12a$states,piecol=cols,cex=0.1)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
pdffn = paste0("polymorphicARDandR1R2ratesfan_open_close_annual_perennial.jpg")
jpeg(file=pdffn, width=3500, height=3500)
plot(mytree,type="fan", show.tip.label = F,cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12a$states,piecol=cols,cex=0.1)
dev.off()
pp.polymorphic12b
pdffn = paste0("corHMMmodel_open_close_C3C4CAM.pdf")
pdf(file=pdffn, width=8, height=8)
plotMKmodel(pp.polymorphic12b, rate.cat = 2, color = "col.blind" )
dev.off()
#"0_0" "0_1" "0_2" "1_0" "1_1" "1_2"
cols <- c("white", "black", "blue", "purple", "cyan", "grey", "red", "yellow", "orange", "green", "pink", "darkgreen")
pdffn = paste0("polymorphicARDandR1R2rates_open_close_C3C4CAM.pdf")
pdf(file=pdffn, width=6, height=200)
plotRECON(mytree,pp.polymorphic12b$states,piecolors=cols, cex=0.2, pie.cex=0.3, show.tip.label=TRUE, title="Open Close C3C4CAM ARD and R1/R2 rates")
dev.off()
trait <- paste(trait12[,2],trait12[,4], sep = "_")
names(trait) <- trait12[,1]
pdffn = paste0("polymorphicARDandR1R2ratesv2_open_close_C3C4CAM.pdf")
pdf(file=pdffn, width=6, height=200)
plot(mytree,type="phylogram",cex=0.2,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12b$states,piecol=cols,cex=0.3)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
cols <- c("white", "black", "blue", "purple", "cyan", "grey", "red", "yellow", "orange", "green", "pink", "darkgreen")
pdffn = paste0("polymorphicARDandR1R2ratesfan_open_close_C3C4CAM.pdf")
pdf(file=pdffn, width=100, height=100)
plot(mytree,type="fan", show.tip.label = F,cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12b$states,piecol=cols,cex=0.1)
add.simmap.legend(colors=cols,prompt=FALSE,x=0.9*par()$usr[1],
y=0.8*par()$usr[3],fsize=2)
dev.off()
pdffn = paste0("polymorphicARDandR1R2ratesfan_open_close_C3C4CAM.jpg")
jpeg(file=pdffn, width=3500, height=3500)
plot(mytree,type="fan", show.tip.label = F,cex=1,font=3,lwd=0.5,label.offset = 1)
tiplabels(pie=to.matrix(trait[mytree$tip.label],
levels(as.factor(trait))),piecol=cols,cex=0.1)
nodelabels(node=1:mytree$Nnode+Ntip(mytree),
pie=pp.polymorphic12b$states,piecol=cols,cex=0.1)
dev.off()
library(corHMM)
library(phytools)
pp.polymorphic12a
pp.polymorphic12a.1
pp.polymorphic12a.2
pp.polymorphic12a.3
library(bayou)
library(slouch)
library(Bayou)
pp.polymorphic12c
library(corHMM)
pp.polymorphic12c
devtools::install_github("jtlovell/GENESPACE")
library(devtools)
if (!requireNamespace("devtools", quietly = TRUE))
install.packages("devtools")
devtools::install_github("jtlovell/GENESPACE")
install.packages("gert")
install.packages("devtools")
install.packages("gert")
install.packages("devtools")
devtools::install_github("jtlovell/GENESPACE")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("Biostrings", "rtracklayer"))
devtools::install_github("jtlovell/GENESPACE")
library(GENESPACE)
