load("hisse.RData")
ls()
install.packages("corHMM")
ls()
traits
traits
traits
trait1 <- cbind(names(traits$WCVP_name), traits$open_closed)
tree
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
trait1 <- cbind(names(traits$WCVP_name), traits$open_closed)
#open_closed
pp.polymorphic<-corHMM(tree,trait1,rate.cat=2,node.states="marginal")
trait1
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
pp.polymorphic<-corHMM(tree,trait1,rate.cat=2,node.states="marginal")
#open_closed
trait1 <- trait1[trait1[,1] != NA]
trati1
trait1
trait1[,1]
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
trait1 <- trait1[trait1[,1] != NA]
trait1
trait1
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
trait1
trait1[,1]
#open_closed
trait1
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait1<-trait1[!is.na(trait1[,2]),]
trait1
tree
tipstoremove <- setdiff(tree$tip.label,trait1[,1])
tipstoremove
mytree <- drop.tip(tree, tipstoremove)
mytree
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
pp.polymorphic
getwd()
update.packages(ask = FALSE, checkBuilt = TRUE)
pp.polymorphic
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
load("hisse.RData")
ls()
traits
tree
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
trait1
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait1<-trait1[!is.na(trait1[,2]),]
tipstoremove <- setdiff(tree$tip.label,trait1[,1])
mytree <- drop.tip(tree, tipstoremove)
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
load("hisse.RData")
ls()
traits
load("hisse.RData")
ls()
traits
tree
trait1 <- cbind(traits$WCVP_name, traits$open_closed)
#open_closed
trait1
trait1[,2][trait1[,2] == ""] <- NA
trait1[,2][trait1[,2] == "1"] <- 1
trait1[,2][trait1[,2] == "0"] <- 0
trait1[,2][trait1[,2] == "01"] <- 1
trait1<-trait1[!is.na(trait1[,2]),]
tipstoremove <- setdiff(tree$tip.label,trait1[,1])
mytree <- drop.tip(tree, tipstoremove)
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
pp.polymorphic<-corHMM(mytree,trait1,rate.cat=2,node.states="marginal")
pp.polymorphic
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
pp.polymorphic.1<-corHMM(mytree,trait1,rate.cat=1,node.states="marginal")
pp.polymorphic.1<-corHMM(mytree,trait1,rate.cat=1,node.states="marginal")
pp.polymorphic.1
#install.packages("corHMM")
library(corHMM)
#install.packages("corHMM")
library(corHMM)
library(phytools)
pp.polymorphic.2<-corHMM(mytree,trait1,rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic.2<-corHMM(mytree,trait1,rate.cat=2, model = "SYM", node.states="marginal")
pp.polymorphic.2
